<ng-container *transloco="let t">
  <nz-card>
    <ng-container *ngIf="user; else spinTemplate">
      <form nz-form nzLayout="vertical" [formGroup]="form">
        <div nz-row nzGutter="16">
          <div nz-col nzFlex="150px">
            <nz-form-item>
              <nz-form-control>
                <tb-profile-avatar
                  formControlName="avatar"
                  [tbFullName]="user.fullName"
                ></tb-profile-avatar>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div nz-col nzFlex="auto">
            <nz-form-item>
              <nz-form-label>{{ t('user.name') }}</nz-form-label>
              <nz-form-control>
                <span nz-typography nzType="secondary">
                  {{ user.username }}
                </span>
              </nz-form-control>
            </nz-form-item>
            <div nz-row nzGutter="16">
              <div nz-col nzFlex="auto">
                <nz-form-item>
                  <nz-form-label nzRequired nzFor="first-name">
                    {{ t('user.first_name') }}
                  </nz-form-label>
                  <nz-form-control>
                    <input
                      nz-input
                      formControlName="firstName"
                      [placeholder]="t('user.first_name')"
                      id="first-name"
                    />
                  </nz-form-control>
                </nz-form-item>
              </div>
              <div nz-col nzFlex="auto">
                <nz-form-item>
                  <nz-form-label nzRequired nzFor="last-name">
                    {{ t('user.last_name') }}
                  </nz-form-label>
                  <nz-form-control>
                    <input
                      nz-input
                      formControlName="lastName"
                      [placeholder]="t('user.last_name')"
                      id="last-name"
                    />
                  </nz-form-control>
                </nz-form-item>
              </div>
            </div>
          </div>
        </div>
        <nz-form-item>
          <nz-form-label nzFor="email">
            {{ t('user.email') }}
          </nz-form-label>
          <nz-form-control>
            <input
              nz-input
              formControlName="email"
              [placeholder]="t('user.email')"
              id="email"
            />
          </nz-form-control>
        </nz-form-item>
      </form>
      <nz-space>
        <button
          *nzSpaceItem
          nz-button
          nzType="primary"
          (click)="handleSave()"
          [disabled]="!canSubmit"
          [nzLoading]="loading"
        >
          {{ t('common.save') }}
        </button>
        <button
          *nzSpaceItem
          nz-button
          (click)="handleReset()"
          [disabled]="!hasChanges"
          [nzLoading]="loading"
        >
          {{ t('common.reset') }}
        </button>
      </nz-space>
    </ng-container>
  </nz-card>
  <ng-template #spinTemplate>
    <nz-spin nzSimple nzSize="large"></nz-spin>
  </ng-template>
</ng-container>
